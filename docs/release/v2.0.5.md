# Release notes — v2.0.5

Released: 2025-11-21

This release focuses on two related improvements: full strict typing for the codebase
and a clearer, more strongly-typed picture API. Important: this release removes several
deprecated compatibility wrappers from the Device API — this is a breaking change.

Highlights
- Enforced strict typing across the entire repository
  - `mypy` is now run in strict mode over the whole project (tests included).
  - Many modules were updated with concrete, well-named type aliases and TypedDicts.
    - New `fmd_api/types.py` centralizes JSON/response types and the new `PictureMetadata` TypedDict.
  - Fixes were applied across the package to remove runtime Any usages and ensure
    proper return annotations and runtime narrowing where needed.

- Device picture APIs improved
  - New method: `Device.get_picture_metadata(num_to_get: int = -1) -> List[PictureMetadata]`
    - Returns only dict-like metadata entries (e.g., id, date, filename, size) when the
      server exposes them.
    - IMPORTANT: To remove historical ambiguity and simplify the public surface, this
      release removes the old backward-compatible wrappers: `fetch_pictures()`,
      `get_pictures()`, `download_photo()`, `get_picture()`, `take_front_photo()`,
      and `take_rear_photo()` are no longer available. Calls must be migrated to the
      canonical APIs: `get_picture_blobs()`, `decode_picture()`, `take_front_picture()`,
      and `take_rear_picture()`.
  - Tests updated and added to assert both behaviors (raw blobs preserved, metadata filtered).

Why this change?
- Strict typing improves long-term maintainability, reduces runtime bugs, and gives
  contributors and users better IDE/typing support.
- The new `get_picture_metadata` method makes it convenient to work with structured
  metadata where available while preserving raw data semantics for older servers and
  decoding use-cases.

Notes for integrators (breaking change)
- Removed APIs: `Device.fetch_pictures`, `Device.get_pictures`, `Device.download_photo`,
  `Device.get_picture`, `Device.take_front_photo`, `Device.take_rear_photo` have been removed in v2.0.5.
- Migration:
  - Replace `fetch_pictures()` / `get_pictures()` -> `get_picture_blobs()`
  - Replace `download_photo()` / `get_picture()` -> `decode_picture()`
  - Replace `take_front_photo()` -> `take_front_picture()` and `take_rear_photo()` -> `take_rear_picture()`
  - If your code depended on these wrappers for deprecated warning behavior, remove that handling.

If you were relying on `get_picture_blobs` returning only dicts, use `get_picture_metadata()` to receive
only metadata entries (dicts) where available.

Migration
- No breaking API changes. Prefer `get_picture_metadata` where you only need metadata.

Acknowledgements
- Thanks to the CI and test suite updates which made enforcing strict typing and landing
  these changes safe across the codebase.
